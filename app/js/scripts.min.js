!function(t){if("object"==typeof exports)module.exports=t();else if("function"==typeof define&&define.amd)define(t);else{var e;"undefined"!=typeof window?e=window:"undefined"!=typeof global?e=global:"undefined"!=typeof self&&(e=self),e.shared=t()}}(function(){return function t(e,n,o){function r(i,u){if(!n[i]){if(!e[i]){var s="function"==typeof require&&require;if(!u&&s)return s(i,!0);if(a)return a(i,!0);throw new Error("Cannot find module '"+i+"'")}var l=n[i]={exports:{}};e[i][0].call(l.exports,function(t){var n=e[i][1][t];return r(n?n:t)},l,l.exports,t,e,n,o)}return n[i].exports}for(var a="function"==typeof require&&require,i=0;i<o.length;i++)r(o[i]);return r}({1:[function(t,e,n){var o=angular.module("myApp",["ngRoute","ngAnimate","toaster","ngMessages","ngCookies"]);o.config(["$routeProvider",function(t){t.when("/login",{title:"Login",templateUrl:"partials/login.html",controller:"authCtrl"}).when("/logout",{title:"Logout",templateUrl:"partials/login.html",controller:"authCtrl"}).when("/signup",{title:"Signup",templateUrl:"partials/signup.html",controller:"authCtrl"}).when("/dashboard",{title:"Dashboard",templateUrl:"partials/dashboard.html",controller:"authCtrl"}).when("/",{title:"Login",templateUrl:"partials/login.html",controller:"authCtrl",role:"0"}).when("/edit-customer/:customerID",{title:"Edit Customers",templateUrl:"partials/edit-customer.html",controller:"editCtrl",resolve:{customer:["Data","$route",function(t,e){e.current.params.customerID;return t.get("session").then(function(t){return t.phone=parseInt(t.phone),t})}]}}).otherwise({redirectTo:"/login"})}]).run(["$rootScope","$location","Data","$cookieStore","$http",function(t,e,n,o,r){t.$on("$routeChangeStart",function(r,a,i){t.authenticated=!1;var u=a.$$route.originalPath;"/logout"==u?t={}:n.get("session").then(function(r){if(r.uid)t.authenticated=!0,t.uid=r.uid,t.name=r.name,t.email=r.email,"/signup"!=u&&"/login"!=u&&"/"!=u||e.path("dashboard");else{if("/signup"!=u&&"/login"!=u&&"/"!=u)return!0;t.globals=o.get("globals")||{},t.globals&&parseInt(Object.keys(t.globals).length)>0&&n.post("login",{customer:t.globals.currentUser}).then(function(t){return n.toast(t),"success"==t.status&&void e.path("dashboard")})}})})}]),function(){"use strict";function t(t,e,n,o){function r(o,r){var a=o+":"+r;n.globals={currentUser:{email:o,password:r,authdata:a}},t.defaults.headers.common.Authorization="Basic "+a;var i=new Date;i.setDate(i.getDate()+7),e.putObject("globals",n.globals,{expires:i}),console.log(e)}function a(){n.globals={},e.remove("globals"),t.defaults.headers.common.Authorization="Basic"}var i={};return i.SetCredentials=r,i.ClearCredentials=a,i}o.factory("AuthenticationService",t),t.$inject=["$http","$cookies","$rootScope","$timeout"]}(),o.factory("countries",function(){var t,e={};return t=[{name:"Bulgaria",code:"BG"},{name:"France",code:"FR"},{name:"Tunisia",code:"TN"},{name:"Vietnam",code:"VN"},{name:"Mauritius",code:"MU"}],e.listCountries=t,e}),o.factory("Data",["$http","toaster",function(t,e){var n="api/v1/",o={};return o.toast=function(t){e.pop(t.status,"",t.message,1e4,"trustedHtml")},o.get=function(e){return t.get(n+e).then(function(t){return t.data})},o.post=function(e,o){return t.post(n+e,o).then(function(t){return t.data})},o.put=function(e,o){return t.put(n+e,o).then(function(t){return t.data})},o.updateCustomer=function(e,o){return t.post(n+e,o).then(function(t){return t.data})},o["delete"]=function(e){return t["delete"](n+e).then(function(t){return t.data})},o}]),o.directive("focus",function(){return function(t,e){e[0].focus()}}),o.directive("passwordMatch",[function(){return{restrict:"A",scope:!0,require:"ngModel",link:function(t,e,n,o){var r=function(){var e=t.$eval(n.ngModel),o=t.$eval(n.passwordMatch);if(null!=o)return e==o};t.$watch(r,function(t){o.$setValidity("passwordNoMatch",t)})}}}]),o.directive("ngUnique",["AuthService",function(t){return{restrict:"A",require:"ngModel",link:function(e,n,o,r){n.bind("blur",function(a){if(r&&n.val()){var i=e.$eval(o.ngUnique),u=n.val();t.checkUniqueValue(i.key,i.property,u).then(function(t){u==n.val()&&(console.log("unique = "+t),r.$setValidity("unique",t),e.$broadcast("show-errors-check-validity"))})}})}}}]),o.controller("authCtrl",["$scope","$rootScope","$routeParams","$location","$http","Data","AuthenticationService","countries",function(t,e,n,o,r,a,i,u){t.login={},t.signup={},t.updateCustomer={},t.doLogin=function(t){t.rememberme&&i.SetCredentials(t.email,t.password),a.post("login",{customer:t}).then(function(t){a.toast(t),"success"==t.status&&o.path("dashboard")})},t.signup={email:"",password:"",name:"",phone:"",country:""},t.signUp=function(t){a.post("signUp",{customer:t}).then(function(t){a.toast(t),"success"==t.status&&o.path("dashboard")})},t.logout=function(){a.get("logout").then(function(t){e.uid="",i.ClearCredentials(),a.toast(t),window.location.replace("#!/login")})},t.countries=u.listCountries}]),o.controller("editCtrl",["$scope","$location","$routeParams","Data","customer","countries",function(t,e,n,o,r,a){var i=n.customerID?parseInt(n.customerID):0,u=r;u.uid=i,t.customer=angular.copy(u),t.customer.uid=i,t.isClean=function(){return angular.equals(u,t.customer)},t.updateCustomer=function(t){var n;n=t,n.name===u.name&&delete n.name,o.post("UpdateCustomer",{customer:n}).then(function(t){o.toast(t),"success"==t.status&&e.path("dashboard")})},t.countries=a.listCountries}])},{}]},{},[1])(1)});